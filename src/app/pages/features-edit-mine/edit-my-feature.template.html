<div class="container mt-3">
    <div class="row">
        <div class="col-md-4">
            <ul class="list-group pl-2">
                <li><a (click)="state = 'edit'; type = '';">Edit</a></li>
                <li><a (click)="state = 'articles'; type = '';">Articles</a></li>
                <li><a (click)="state = 'body'; type = '';">Content</a></li>
                <li><a (click)="state = 'publish'; type = '';">Publish</a></li>
            </ul>
        </div>
        <div class="col-md-4">

            <alert-status [type]="type" [msg]="msg" *ngIf="type && msg"></alert-status>

            <div [ngbCollapse]="state != 'edit'">
                <h3>Edit Feature Info</h3>
                <form [formGroup]="feature.form">
                    <div class="form-group">
                        <label for="title">Title</label>
                        <input type="text" class="form-control" id="title" placeholder="Title" formControlName="title">
                    </div>
                    <div class="form-group">
                        <label for="link">URL Path</label>
                        <input type="text" class="form-control" id="link" placeholder="URL Path" formControlName="link">
                    </div>
                    <div class="form-group">
                        <label for="summary">Summary</label>
                        <textarea class="form-control" id="summary" rows="3" placeholder="Summary" formControlName="deck">
                    </textarea>
                    </div>
                </form>

                <form-tags [tags]="feature.tags" (changed)="onTagChanged($event)"></form-tags>

                <button class="btn btn-primary"
                        [disabled]="!feature.form.valid"
                        (click)="save();">
                    Update
                </button>
            </div>

            <div [ngbCollapse]="state != 'articles'">
                <h3>Edit Feature Articles</h3>

                <div class="mt-3 mb-3">
                    <div *ngFor="let article of currentArticles">
                        <i class="fa fa-close pull-right" (click)="removeItem(article._id)"></i>
                        {{article.title}}
                    </div>
                </div>

                <ng-template #rt let-r="result" let-t="term">
                    <span [innerHTML]="r.title"></span>
                </ng-template>
                <div class="input-group">
                    <input id="articles" type="text" placeholder="Enter Article Title"
                           [ngbTypeahead]="search" [resultTemplate]="rt" (selectItem)="selectItem($event)"
                           class="form-control" />
                </div>

            </div>

            <div [ngbCollapse]="state !== 'body'">
                <h3>Edit Feature Content</h3>
                <div class="form-group">
                    <label for="content">Content</label>
                    <textarea class="form-control" id="content" rows="3" placeholder="Feature Content" [(ngModel)]="feature.body"></textarea>
                </div>
                <button class="btn btn-primary"
                        (click)="updateBody();">
                    Update
                </button>
            </div>

            <div [ngbCollapse]="state !== 'publish'">
                <h3>Edit Publishing</h3>
                <p>
                    Published: {{feature.published}}
                </p>

                <button class="btn btn-primary" *ngIf="feature.published" (click)="publish(0)">
                    Unpublish
                </button>

                <button class="btn btn-primary" *ngIf="!feature.published" (click)="publish(1)">
                    Publish
                </button>
            </div>

        </div>
    </div>
</div>